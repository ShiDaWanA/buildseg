import{B as $}from"./BaseTitle-588acb84.js";import{d as F,r as f,a as N,D as w,H as A,l as V,c as i,e as R,h as e,f as j,w as l,F as G,o as H,i as _,g as r,E as I,a5 as S}from"./index-ab68adb5.js";const J={class:"flex-gap-8"},X=F({__name:"Organization",setup(K){const m=f(!1),y=f([]),b=f();let a=f({id:void 0,name:"",organizationType:"",contactPerson:"",contactPhone:"",address:"",province:"",city:""});const x=N({name:[{required:!0,message:"请请输入机构名称",trigger:"blur"}],contactPerson:[{required:!0,message:"请输入联系人",trigger:"blur"}],contactPhone:[{required:!0,message:"请输入联系电话",trigger:"blur"}]}),c=f(""),P=w(()=>y.value.filter(n=>!c.value||n.name.toLowerCase().includes(c.value.toLowerCase())||n.contactPerson.toLowerCase().includes(c.value.toLowerCase()))),h=w(()=>a.value.id?"编辑":"新建");A(()=>{g()});const g=()=>{V.get("api/Organization/GetAll").then(n=>{y.value=n})},k=()=>{var n;(n=b.value)==null||n.resetFields(),a.value.id=void 0},T=()=>{m.value=!0},U=()=>{var n;(n=b.value)==null||n.validate(o=>{if(o){let s=a.value.id?"Update":"Create";V.post(`api/Organization/${s}`,a.value).then(()=>{m.value=!1,g(),I({message:"提交成功",type:"success"})})}})},z=n=>{m.value=!0,S(()=>{a.value={...n}})},M=n=>{V.post("api/Organization/Delete/"+n.id).then(()=>{g()})};return(n,o)=>{const s=i("el-button"),u=i("el-input"),D=i("el-divider"),d=i("el-table-column"),B=i("el-popconfirm"),q=i("el-table"),p=i("el-form-item"),v=i("el-col"),C=i("el-row"),E=i("el-form"),L=i("el-dialog");return H(),R(G,null,[e($,{title:"机构管理",icon:"icon-jigou"}),j("div",J,[e(s,{type:"primary",onClick:T},{default:l(()=>[_("新建机构")]),_:1}),e(u,{modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=t=>c.value=t),modelModifiers:{trim:!0},style:{width:"300px"},placeholder:"输入关键字搜索",clearable:""},null,8,["modelValue"])]),e(D),e(q,{data:P.value,height:"calc(100vh - 223px)"},{default:l(()=>[e(d,{type:"index",width:"50"}),e(d,{prop:"name",label:"机构名称"}),e(d,{prop:"organizationType",label:"机构类型"}),e(d,{prop:"contactPerson",label:"联系人"}),e(d,{prop:"contactPhone",label:"联系电话"}),e(d,{prop:"province",label:"省"}),e(d,{prop:"city",label:"市"}),e(d,{prop:"address",label:"地址"}),e(d,{prop:"userCount",label:"用户数"}),e(d,{prop:"created",label:"创建时间",width:"160"}),e(d,{width:"150","class-name":"hover-to-show"},{default:l(t=>[e(s,{type:"primary",link:"",onClick:O=>z(t.row)},{default:l(()=>[_("编辑")]),_:2},1032,["onClick"]),e(B,{width:"170","confirm-button-text":"删除","cancel-button-text":"取消",title:"确认删除此机构么?",onConfirm:O=>M(t.row)},{reference:l(()=>[e(s,{type:"danger",link:""},{default:l(()=>[_("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),e(L,{title:h.value,modelValue:m.value,"onUpdate:modelValue":o[9]||(o[9]=t=>m.value=t),"close-on-click-modal":!1,width:"450px",onClosed:k},{footer:l(()=>[e(s,{onClick:o[8]||(o[8]=t=>m.value=!1)},{default:l(()=>[_("取消")]),_:1}),e(s,{type:"primary",onClick:U},{default:l(()=>[_("提交")]),_:1})]),default:l(()=>[e(E,{model:r(a),rules:x,ref_key:"formRef",ref:b,"label-position":"top"},{default:l(()=>[e(p,{label:"机构名称",prop:"name"},{default:l(()=>[e(u,{modelValue:r(a).name,"onUpdate:modelValue":o[1]||(o[1]=t=>r(a).name=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),e(p,{label:"机构类型",prop:"organizationType"},{default:l(()=>[e(u,{modelValue:r(a).organizationType,"onUpdate:modelValue":o[2]||(o[2]=t=>r(a).organizationType=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),e(C,{gutter:32},{default:l(()=>[e(v,{span:12},{default:l(()=>[e(p,{label:"联系人",prop:"contactPerson"},{default:l(()=>[e(u,{modelValue:r(a).contactPerson,"onUpdate:modelValue":o[3]||(o[3]=t=>r(a).contactPerson=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:12},{default:l(()=>[e(p,{label:"手机号码",prop:"contactPhone"},{default:l(()=>[e(u,{modelValue:r(a).contactPhone,"onUpdate:modelValue":o[4]||(o[4]=t=>r(a).contactPhone=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:32},{default:l(()=>[e(v,{span:12},{default:l(()=>[e(p,{label:"省",prop:"province"},{default:l(()=>[e(u,{modelValue:r(a).province,"onUpdate:modelValue":o[5]||(o[5]=t=>r(a).province=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:12},{default:l(()=>[e(p,{label:"市",prop:"city"},{default:l(()=>[e(u,{modelValue:r(a).city,"onUpdate:modelValue":o[6]||(o[6]=t=>r(a).city=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,{label:"详细地址",prop:"address"},{default:l(()=>[e(u,{type:"textarea",modelValue:r(a).address,"onUpdate:modelValue":o[7]||(o[7]=t=>r(a).address=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])],64)}}});export{X as default};
