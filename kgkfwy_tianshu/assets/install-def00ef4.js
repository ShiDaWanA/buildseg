import{P as ze,bd as I,be as Ae,an as Le,bf as Ce,I as je,V as xe,bg as we,bh as ge,aM as Fe,a8 as Ue,a0 as fe,bi as G,T as ee,A as Ne,bj as Xe,_ as he,O as qe,o as Y,aq as te,k as ce,j as De,s as $e,J as He,t as Ze,p as Je,m as We,bk as Ke,at as Oe,ap as Qe,L as et,aA as tt,aC as at,al as Me,ag as Ve,bl as rt,bm as nt,bn as it,g as lt,aG as ot,bo as st}from"./index.esm.min-90f1887f.js";ze.CMD;function Ee(t,a,r,e,i,l,n,o){var c=i-t,u=l-a,s=r-t,f=e-a,d=Math.sqrt(s*s+f*f);s/=d,f/=d;var v=c*s+u*f,g=v/d;o&&(g=Math.min(Math.max(g,0),1)),g*=d;var h=n[0]=t+g*s,p=n[1]=a+g*f;return Math.sqrt((h-i)*(h-i)+(p-l)*(p-l))}var R=new I,x=new I,P=new I,B=new I,k=new I,re=[],N=new I;function vt(t,a){if(a<=180&&a>0){a=a/180*Math.PI,R.fromArray(t[0]),x.fromArray(t[1]),P.fromArray(t[2]),I.sub(B,R,x),I.sub(k,P,x);var r=B.len(),e=k.len();if(!(r<.001||e<.001)){B.scale(1/r),k.scale(1/e);var i=B.dot(k),l=Math.cos(a);if(l<i){var n=Ee(x.x,x.y,P.x,P.y,R.x,R.y,re,!1);N.fromArray(re),N.scaleAndAdd(k,n/Math.tan(Math.PI-a));var o=P.x!==x.x?(N.x-x.x)/(P.x-x.x):(N.y-x.y)/(P.y-x.y);if(isNaN(o))return;o<0?I.copy(N,x):o>1&&I.copy(N,P),N.toArray(t[1])}}}}function gt(t,a,r){if(r<=180&&r>0){r=r/180*Math.PI,R.fromArray(t[0]),x.fromArray(t[1]),P.fromArray(t[2]),I.sub(B,x,R),I.sub(k,P,x);var e=B.len(),i=k.len();if(!(e<.001||i<.001)){B.scale(1/e),k.scale(1/i);var l=B.dot(a),n=Math.cos(r);if(l<n){var o=Ee(x.x,x.y,P.x,P.y,R.x,R.y,re,!1);N.fromArray(re);var c=Math.PI/2,u=Math.acos(k.dot(a)),s=c+u-r;if(s>=c)I.copy(N,P);else{N.scaleAndAdd(k,o/Math.tan(Math.PI/2-s));var f=P.x!==x.x?(N.x-x.x)/(P.x-x.x):(N.y-x.y)/(P.y-x.y);if(isNaN(f))return;f<0?I.copy(N,x):f>1&&I.copy(N,P)}N.toArray(t[1])}}}}function Te(t,a,r,e){var i=r==="normal",l=i?t:t.ensureState(r);l.ignore=a;var n=e.get("smooth");n&&n===!0&&(n=.3),l.shape=l.shape||{},n>0&&(l.shape.smooth=n);var o=e.getModel("lineStyle").getLineStyle();i?t.useStyle(o):l.style=o}function ct(t,a){var r=a.smooth,e=a.points;if(e)if(t.moveTo(e[0][0],e[0][1]),r>0&&e.length>=3){var i=we(e[0],e[1]),l=we(e[1],e[2]);if(!i||!l){t.lineTo(e[1][0],e[1][1]),t.lineTo(e[2][0],e[2][1]);return}var n=Math.min(i,l)*r,o=ge([],e[1],e[0],n/i),c=ge([],e[1],e[2],n/l),u=ge([],o,c,.5);t.bezierCurveTo(o[0],o[1],o[0],o[1],u[0],u[1]),t.bezierCurveTo(c[0],c[1],c[0],c[1],e[2][0],e[2][1])}else for(var s=1;s<e.length;s++)t.lineTo(e[s][0],e[s][1])}function ut(t,a,r){var e=t.getTextGuideLine(),i=t.getTextContent();if(!i){e&&t.removeTextGuideLine();return}for(var l=a.normal,n=l.get("show"),o=i.ignore,c=0;c<Ae.length;c++){var u=Ae[c],s=a[u],f=u==="normal";if(s){var d=s.get("show"),v=f?o:Le(i.states[u]&&i.states[u].ignore,o);if(v||!Le(d,n)){var g=f?e:e&&e.states[u];g&&(g.ignore=!0);continue}e||(e=new Ce,t.setTextGuideLine(e),!f&&(o||!n)&&Te(e,!0,"normal",a.normal),t.stateProxy&&(e.stateProxy=t.stateProxy)),Te(e,!1,u,s)}}if(e){je(e.style,r),e.style.fill=null;var h=l.get("showAbove"),p=t.textGuideLineConfig=t.textGuideLineConfig||{};p.showAbove=h||!1,e.buildPath=ct}}function ft(t,a){a=a||"labelLine";for(var r={normal:t.getModel(a)},e=0;e<xe.length;e++){var i=xe[e];r[i]=t.getModel([i,a])}return r}var ae=Math.PI*2,Pe=Math.PI/180;function ke(t,a){return Ue(t.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()})}function Ge(t,a){var r=ke(t,a),e=t.get("center"),i=t.get("radius");fe(i)||(i=[0,i]);var l=G(r.width,a.getWidth()),n=G(r.height,a.getHeight()),o=Math.min(l,n),c=G(i[0],o/2),u=G(i[1],o/2),s,f,d=t.coordinateSystem;if(d){var v=d.dataToPoint(e);s=v[0]||0,f=v[1]||0}else fe(e)||(e=[e,e]),s=G(e[0],l)+r.x,f=G(e[1],n)+r.y;return{cx:s,cy:f,r0:c,r:u}}function ht(t,a,r){a.eachSeriesByType(t,function(e){var i=e.getData(),l=i.mapDimension("value"),n=ke(e,r),o=Ge(e,r),c=o.cx,u=o.cy,s=o.r,f=o.r0,d=-e.get("startAngle")*Pe,v=e.get("minAngle")*Pe,g=0;i.each(l,function(T){!isNaN(T)&&g++});var h=i.getSum(l),p=Math.PI/(h||g)*2,y=e.get("clockwise"),b=e.get("roseType"),S=e.get("stillShowZeroSum"),C=i.getDataExtent(l);C[0]=0;var A=ae,M=0,w=d,m=y?1:-1;if(i.setLayout({viewRect:n,r:s}),i.each(l,function(T,V){var D;if(isNaN(T)){i.setItemLayout(V,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:y,cx:c,cy:u,r0:f,r:b?NaN:s});return}b!=="area"?D=h===0&&S?p:T*p:D=ae/g,D<v?(D=v,A-=v):M+=T;var O=w+m*D;i.setItemLayout(V,{angle:D,startAngle:w,endAngle:O,clockwise:y,cx:c,cy:u,r0:f,r:b?Fe(T,C,[f,s]):s}),w=O}),A<ae&&g)if(A<=.001){var L=ae/g;i.each(l,function(T,V){if(!isNaN(T)){var D=i.getItemLayout(V);D.angle=L,D.startAngle=d+m*V*L,D.endAngle=d+m*(V+1)*L}})}else p=A/M,w=d,i.each(l,function(T,V){if(!isNaN(T)){var D=i.getItemLayout(V),O=D.angle===v?v:T*p;D.startAngle=w,D.endAngle=w+m*O,w+=m*O}})})}function dt(t){return{seriesType:t,reset:function(a,r){var e=r.findComponents({mainType:"legend"});if(!(!e||!e.length)){var i=a.getData();i.filterSelf(function(l){for(var n=i.getName(l),o=0;o<e.length;o++)if(!e[o].isSelected(n))return!1;return!0})}}}}var pt=Math.PI/180;function Ie(t,a,r,e,i,l,n,o,c,u){if(t.length<2)return;function s(h){for(var p=h.rB,y=p*p,b=0;b<h.list.length;b++){var S=h.list[b],C=Math.abs(S.label.y-r),A=e+S.len,M=A*A,w=Math.sqrt((1-Math.abs(C*C/y))*M),m=a+(w+S.len2)*i,L=m-S.label.x,T=S.targetTextWidth-L*i;Re(S,T,!0),S.label.x=m}}function f(h){for(var p={list:[],maxY:0},y={list:[],maxY:0},b=0;b<h.length;b++)if(h[b].labelAlignTo==="none"){var S=h[b],C=S.label.y>r?y:p,A=Math.abs(S.label.y-r);if(A>=C.maxY){var M=S.label.x-a-S.len2*i,w=e+S.len,m=Math.abs(M)<w?Math.sqrt(A*A/(1-M*M/w/w)):w;C.rB=m,C.maxY=A}C.list.push(S)}s(p),s(y)}for(var d=t.length,v=0;v<d;v++)if(t[v].position==="outer"&&t[v].labelAlignTo==="labelLine"){var g=t[v].label.x-u;t[v].linePoints[1][0]+=g,t[v].label.x=u}Xe(t,c,c+n)&&f(t)}function mt(t,a,r,e,i,l,n,o){for(var c=[],u=[],s=Number.MAX_VALUE,f=-Number.MAX_VALUE,d=0;d<t.length;d++){var v=t[d].label;ue(t[d])||(v.x<a?(s=Math.min(s,v.x),c.push(t[d])):(f=Math.max(f,v.x),u.push(t[d])))}for(var d=0;d<t.length;d++){var g=t[d];if(!ue(g)&&g.linePoints){if(g.labelStyleWidth!=null)continue;var v=g.label,h=g.linePoints,p=void 0;g.labelAlignTo==="edge"?v.x<a?p=h[2][0]-g.labelDistance-n-g.edgeDistance:p=n+i-g.edgeDistance-h[2][0]-g.labelDistance:g.labelAlignTo==="labelLine"?v.x<a?p=s-n-g.bleedMargin:p=n+i-f-g.bleedMargin:v.x<a?p=v.x-n-g.bleedMargin:p=n+i-v.x-g.bleedMargin,g.targetTextWidth=p,Re(g,p)}}Ie(u,a,r,e,1,i,l,n,o,f),Ie(c,a,r,e,-1,i,l,n,o,s);for(var d=0;d<t.length;d++){var g=t[d];if(!ue(g)&&g.linePoints){var v=g.label,h=g.linePoints,y=g.labelAlignTo==="edge",b=v.style.padding,S=b?b[1]+b[3]:0,C=v.style.backgroundColor?0:S,A=g.rect.width+C,M=h[1][0]-h[2][0];y?v.x<a?h[2][0]=n+g.edgeDistance+A+g.labelDistance:h[2][0]=n+i-g.edgeDistance-A-g.labelDistance:(v.x<a?h[2][0]=v.x+g.labelDistance:h[2][0]=v.x-g.labelDistance,h[1][0]=h[2][0]+M),h[1][1]=h[2][1]=v.y}}}function Re(t,a,r){if(r===void 0&&(r=!1),t.labelStyleWidth==null){var e=t.label,i=e.style,l=t.rect,n=i.backgroundColor,o=i.padding,c=o?o[1]+o[3]:0,u=i.overflow,s=l.width+(n?0:c);if(a<s||r){var f=l.height;if(u&&u.match("break")){e.setStyle("backgroundColor",null),e.setStyle("width",a-c);var d=e.getBoundingRect();e.setStyle("width",Math.ceil(d.width)),e.setStyle("backgroundColor",n)}else{var v=a-c,g=a<s?v:r?v>t.unconstrainedWidth?null:v:null;e.setStyle("width",g)}var h=e.getBoundingRect();l.width=h.width;var p=(e.style.margin||0)+2.1;l.height=h.height+p,l.y-=(l.height-f)/2}}}function ue(t){return t.position==="center"}function yt(t){var a=t.getData(),r=[],e,i,l=!1,n=(t.get("minShowLabelAngle")||0)*pt,o=a.getLayout("viewRect"),c=a.getLayout("r"),u=o.width,s=o.x,f=o.y,d=o.height;function v(M){M.ignore=!0}function g(M){if(!M.ignore)return!0;for(var w in M.states)if(M.states[w].ignore===!1)return!0;return!1}a.each(function(M){var w=a.getItemGraphicEl(M),m=w.shape,L=w.getTextContent(),T=w.getTextGuideLine(),V=a.getItemModel(M),D=V.getModel("label"),O=D.get("position")||V.get(["emphasis","label","position"]),ne=D.get("distanceToLabelLine"),ie=D.get("alignTo"),le=G(D.get("edgeDistance"),u),Be=D.get("bleedMargin"),Z=V.getModel("labelLine"),U=Z.get("length");U=G(U,u);var J=Z.get("length2");if(J=G(J,u),Math.abs(m.endAngle-m.startAngle)<n){ee(L.states,v),L.ignore=!0,T&&(ee(T.states,v),T.ignore=!0);return}if(g(L)){var W=(m.startAngle+m.endAngle)/2,E=Math.cos(W),_=Math.sin(W),X,K,de,Q;e=m.cx,i=m.cy;var z=O==="inside"||O==="inner";if(O==="center")X=m.cx,K=m.cy,Q="center";else{var oe=(z?(m.r+m.r0)/2*E:m.r*E)+e,se=(z?(m.r+m.r0)/2*_:m.r*_)+i;if(X=oe+E*3,K=se+_*3,!z){var pe=oe+E*(U+c-m.r),me=se+_*(U+c-m.r),ye=pe+(E<0?-1:1)*J,be=me;ie==="edge"?X=E<0?s+le:s+u-le:X=ye+(E<0?-ne:ne),K=be,de=[[oe,se],[pe,me],[ye,be]]}Q=z?"center":ie==="edge"?E>0?"right":"left":E>0?"left":"right"}var q=Math.PI,j=0,$=D.get("rotate");if(Ne($))j=$*(q/180);else if(O==="center")j=0;else if($==="radial"||$===!0){var _e=E<0?-W+q:-W;j=_e}else if($==="tangential"&&O!=="outside"&&O!=="outer"){var F=Math.atan2(E,_);F<0&&(F=q*2+F);var Ye=_>0;Ye&&(F=q+F),j=F-q}if(l=!!j,L.x=X,L.y=K,L.rotation=j,L.setStyle({verticalAlign:"middle"}),z){L.setStyle({align:Q});var ve=L.states.select;ve&&(ve.x+=L.x,ve.y+=L.y)}else{var H=L.getBoundingRect().clone();H.applyTransform(L.getComputedTransform());var Se=(L.style.margin||0)+2.1;H.y-=Se/2,H.height+=Se,r.push({label:L,labelLine:T,position:O,len:U,len2:J,minTurnAngle:Z.get("minTurnAngle"),maxSurfaceAngle:Z.get("maxSurfaceAngle"),surfaceNormal:new I(E,_),linePoints:de,textAlign:Q,labelDistance:ne,labelAlignTo:ie,edgeDistance:le,bleedMargin:Be,rect:H,unconstrainedWidth:H.width,labelStyleWidth:L.style.width})}w.setTextConfig({inside:z})}}),!l&&t.get("avoidLabelOverlap")&&mt(r,e,i,c,u,d,s,f);for(var h=0;h<r.length;h++){var p=r[h],y=p.label,b=p.labelLine,S=isNaN(y.x)||isNaN(y.y);if(y){y.setStyle({align:p.textAlign}),S&&(ee(y.states,v),y.ignore=!0);var C=y.states.select;C&&(C.x+=y.x,C.y+=y.y)}if(b){var A=p.linePoints;S||!A?(ee(b.states,v),b.ignore=!0):(vt(A,p.minTurnAngle),gt(A,p.surfaceNormal,p.maxSurfaceAngle),b.setShape({points:A}),y.__hostTarget.textGuideLineConfig={anchor:new I(A[0][0],A[0][1])})}}}var bt=function(t){he(a,t);function a(r,e,i){var l=t.call(this)||this;l.z2=2;var n=new qe;return l.setTextContent(n),l.updateData(r,e,i,!0),l}return a.prototype.updateData=function(r,e,i,l){var n=this,o=r.hostModel,c=r.getItemModel(e),u=c.getModel("emphasis"),s=r.getItemLayout(e),f=Y(te(c.getModel("itemStyle"),s,!0),s);if(isNaN(f.startAngle)){n.setShape(f);return}if(l){n.setShape(f);var d=o.getShallow("animationType");o.ecModel.ssr?(ce(n,{scaleX:0,scaleY:0},o,{dataIndex:e,isFrom:!0}),n.originX=f.cx,n.originY=f.cy):d==="scale"?(n.shape.r=s.r0,ce(n,{shape:{r:s.r}},o,e)):i!=null?(n.setShape({startAngle:i,endAngle:i}),ce(n,{shape:{startAngle:s.startAngle,endAngle:s.endAngle}},o,e)):(n.shape.endAngle=s.startAngle,De(n,{shape:{endAngle:s.endAngle}},o,e))}else $e(n),De(n,{shape:f},o,e);n.useStyle(r.getItemVisual(e,"style")),He(n,c);var v=(s.startAngle+s.endAngle)/2,g=o.get("selectedOffset"),h=Math.cos(v)*g,p=Math.sin(v)*g,y=c.getShallow("cursor");y&&n.attr("cursor",y),this._updateLabel(o,r,e),n.ensureState("emphasis").shape=Y({r:s.r+(u.get("scale")&&u.get("scaleSize")||0)},te(u.getModel("itemStyle"),s)),Y(n.ensureState("select"),{x:h,y:p,shape:te(c.getModel(["select","itemStyle"]),s)}),Y(n.ensureState("blur"),{shape:te(c.getModel(["blur","itemStyle"]),s)});var b=n.getTextGuideLine(),S=n.getTextContent();b&&Y(b.ensureState("select"),{x:h,y:p}),Y(S.ensureState("select"),{x:h,y:p}),Ze(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},a.prototype._updateLabel=function(r,e,i){var l=this,n=e.getItemModel(i),o=n.getModel("labelLine"),c=e.getItemVisual(i,"style"),u=c&&c.fill,s=c&&c.opacity;Je(l,We(n),{labelFetcher:e.hostModel,labelDataIndex:i,inheritColor:u,defaultOpacity:s,defaultText:r.getFormattedLabel(i,"normal")||e.getName(i)});var f=l.getTextContent();l.setTextConfig({position:null,rotation:null}),f.attr({z2:10});var d=r.get(["label","position"]);if(d!=="outside"&&d!=="outer")l.removeTextGuideLine();else{var v=this.getTextGuideLine();v||(v=new Ce,this.setTextGuideLine(v)),ut(this,ft(n),{stroke:u,opacity:Ke(o.get(["lineStyle","opacity"]),s,1)})}},a}(Oe),St=function(t){he(a,t);function a(){var r=t!==null&&t.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return a.prototype.render=function(r,e,i,l){var n=r.getData(),o=this._data,c=this.group,u;if(!o&&n.count()>0){for(var s=n.getItemLayout(0),f=1;isNaN(s&&s.startAngle)&&f<n.count();++f)s=n.getItemLayout(f);s&&(u=s.startAngle)}if(this._emptyCircleSector&&c.remove(this._emptyCircleSector),n.count()===0&&r.get("showEmptyCircle")){var d=new Oe({shape:Ge(r,i)});d.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=d,c.add(d)}n.diff(o).add(function(v){var g=new bt(n,v,u);n.setItemGraphicEl(v,g),c.add(g)}).update(function(v,g){var h=o.getItemGraphicEl(g);h.updateData(n,v,u),h.off("click"),c.add(h),n.setItemGraphicEl(v,h)}).remove(function(v){var g=o.getItemGraphicEl(v);Qe(g,r,v)}).execute(),yt(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=n)},a.prototype.dispose=function(){},a.prototype.containPoint=function(r,e){var i=e.getData(),l=i.getItemLayout(0);if(l){var n=r[0]-l.cx,o=r[1]-l.cy,c=Math.sqrt(n*n+o*o);return c<=l.r&&c>=l.r0}},a.type="pie",a}(et);const At=St;function Lt(t,a,r){a=fe(a)&&{coordDimensions:a}||Y({encodeDefine:t.getEncode()},a);var e=t.getSource(),i=tt(e,a).dimensions,l=new at(i,t);return l.initData(e,r),l}var xt=function(){function t(a,r){this._getDataWithEncodedVisual=a,this._getRawData=r}return t.prototype.getAllNames=function(){var a=this._getRawData();return a.mapArray(a.getName)},t.prototype.containName=function(a){var r=this._getRawData();return r.indexOfName(a)>=0},t.prototype.indexOfName=function(a){var r=this._getDataWithEncodedVisual();return r.indexOfName(a)},t.prototype.getItemVisual=function(a,r){var e=this._getDataWithEncodedVisual();return e.getItemVisual(a,r)},t}();const wt=xt;var Dt=ot(),Mt=function(t){he(a,t);function a(){return t!==null&&t.apply(this,arguments)||this}return a.prototype.init=function(r){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new wt(Me(this.getData,this),Me(this.getRawData,this)),this._defaultLabelLine(r)},a.prototype.mergeOption=function(){t.prototype.mergeOption.apply(this,arguments)},a.prototype.getInitialData=function(){return Lt(this,{coordDimensions:["value"],encodeDefaulter:Ve(rt,this)})},a.prototype.getDataParams=function(r){var e=this.getData(),i=Dt(e),l=i.seats;if(!l){var n=[];e.each(e.mapDimension("value"),function(c){n.push(c)}),l=i.seats=nt(n,e.hostModel.get("percentPrecision"))}var o=t.prototype.getDataParams.call(this,r);return o.percent=l[r]||0,o.$vars.push("percent"),o},a.prototype._defaultLabelLine=function(r){it(r,"labelLine",["show"]);var e=r.labelLine,i=r.emphasis.labelLine;e.show=e.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},a.type="series.pie",a.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},a}(lt);const Tt=Mt;function Pt(t){return{seriesType:t,reset:function(a,r){var e=a.getData();e.filterSelf(function(i){var l=e.mapDimension("value"),n=e.get(l,i);return!(Ne(n)&&!isNaN(n)&&n<0)})}}}function Ct(t){t.registerChartView(At),t.registerSeriesModel(Tt),st("pie",t.registerAction),t.registerLayout(Ve(ht,"pie")),t.registerProcessor(dt("pie")),t.registerProcessor(Pt("pie"))}export{Ct as i};
